# 3장: 성능 측정(프로파일링) - 요약

## 📌 핵심 개념

- **측정 없이 개선 없다**: 추측이 아닌 데이터 기반 의사결정
- **추적-프로파일-분석 흐름**: 증상 관찰 → 추적 데이터 수집 → 프로파일로 정리 → 의사결정
- **프로파일링**: 이벤트별 실행 시간·횟수·평균을 집계해 병목 파악
- **병목의 정의**: 응답 시간 대부분을 차지하는 리소스
- **성능은 기능**: 중요 기능의 응답 시간은 기록·모니터링·비교 가능해야 함

## 🎓 주요 교훈

**프로파일러의 과제**
- 중첩 이벤트 처리 (부모-자식 관계 구분, 이중 계산 방지)
- 커버리지 설명 (추적이 코드 경로 전부를 대표하지 못할 수 있음)
- 대용량 처리 성능 (수백만 이벤트 빠른 집계)

**측정 침입(오버헤드)**
- 이상적: ±5% 이내
- 허용범위: 큰 개선(1시간→30분)이 가능하면 투자 가치 있음

**캐시 효과**
- 첫 실행(캐시 미스) vs 반복 실행(캐시 히트) 구분 측정

## 💡 실행 가능한 가이드

### Method R 관점의 추적-프로파일 절차

1. **증상 S 관찰**: 문제 발생 순간에 직접 봄
2. **프로그램 P 추적**: 증상이 나타나는 실행 캡처
3. **추적량 제어**: 실행 시간이 목표의 3배 넘으면 중단
4. **프로파일 생성**: 이벤트 카운트·시간 정리
5. **원인 C 식별**: 데이터 기반으로 병목 찾기
6. **조치 실행**: 수정 또는 자원 추가
7. **검증**: 재측정으로 개선 확인

### 병목 해결의 2가지 방법

1. **이벤트 카운트 감소**
   - 불필요 호출 제거
   - 중복 작업 제거
   - 루프 횟수 감소

2. **이벤트 시간 감소**
   - 더 빠른 알고리즘
   - IO/네트워크 최적화
   - 하드웨어 증설

### 추적 전략

**세션 타기팅**: 특정 사용자/그룹만 추적 (프로덕션 오버헤드 감소)

**관점 타기팅**: DB 호출, 시스템 호출, 캐시 조작 중 선택적 수집

**상세 수준 조정**: 깊이 있는 기록 vs 가벼운 샘플링 선택

**환경별 전략**: 프로덕션(가벼운 샘플링) vs 테스트(상세 추적)

## 📋 체크리스트

- [ ] 증상이 나타나는 실행을 직접 추적했는가?
- [ ] 추적을 기능/세션/관점으로 적절히 제한했는가?
- [ ] 프로파일에서 이벤트 카운트와 시간을 모두 확인했는가?
- [ ] 병목을 카운트 감소로 풀지, 시간 감소로 풀지 결정했는가?
- [ ] 측정 오버헤드는 ±5% 이내인가?
- [ ] 캐시 히트/미스를 구분해 측정했는가?
- [ ] 변경 후 다시 측정해 개선을 검증했는가?

## 🎯 한 문장 요약

> **성능 문제를 해결하려면 추적으로 데이터를 모으고 프로파일로 정리해 병목을 찾아야 한다.**

---

[← 이전: 2장 - Method R 방법론](02-method-r-summary.md) | [다음: 4장 - 최적화 기법 →](04-optimization-techniques-summary.md)
