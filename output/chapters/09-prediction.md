# 9장: 예측

---

## 00. 들어가며

프로파일이 있으면 “만약 ~한다면?”을 산수 없이도 가늠할 수 있다.  
이 장은 프로파일 기반으로 **무엇을 할지/말지** 결정하고, 선형·비선형 효과를 구분하는 방법을 다룬다.

---

## 01. TPS 예측: 할지 말지 (#067)

- TPS 보고서 프로파일 예시: 디스크 읽기 총 0.1초(0.1%), 나머지 99.9%는 비-디스크 작업.  
- 결론: 초고속 스토리지 구매로는 TPS가 0.1% 이상 개선되지 않음 → **무의미한 투입**임을 예측.  
- 달라스 급여 CPU 업그레이드처럼, 프로파일 없이 자원 추가는 실패하기 쉽다.

---

## 02. 선형 동작 (#068)

- 프로파일 표에서 각 행의 총시간 = 실행 횟수 × 평균 실행시간.  
- 개선 방법은 단 두 가지:
  1) **카운트 줄이기(C열)**  
  2) **평균 시간 줄이기(D열)**  
- 스프레드시트로 가정해, C·D 변화가 B(총시간)에 어떻게 반영될지 직접 곱해보면 “만약 ~한다면”을 예측할 수 있다.

---

## 03. 왜곡(skew) 주의 (#069)

- 길이가 긴 프로파일 평균에는 **이상치와 분포**가 숨어 있다.  
- 예: ‘단일 블록 읽기’ 1,001만 회, 평균 0.006초 → 절반 제거 시 절약 시간은 **어떤 호출을 제거하느냐**에 따라 달라짐.  
- 실행시간 버킷으로 분포를 보고(최소~최대) 어떤 부분을 줄일지 결정해야 한다.

### 버킷별 제거 효과
- 느린 버킷(예: 7, 8번)의 적은 호출을 없애면 수 시간 단축 가능.
- 빠른 버킷(예: 3번)만 제거하면 호출은 많이 지워도 시간 절감은 미미.
- 평균 뒤에 숨은 분포를 먼저 본다.

---

## 04. 비선형 효과: H곡, U선형 등 (#069~#071)

- 대기열·상호의존성·왜곡으로 인해 “선형 예측”이 빗나갈 수 있다.  
- 호출 간 상호의존성, 대기열 효과, 리소스 경합은 응답·처리량을 **비선형**(하키 스틱, U-곡선 등)으로 만든다.  
- 결론: 선형 곱셈으로 1차 예측 후, 대기열/왜곡/의존성 여부를 검토해 보정한다.

### 상호의존성 예시 (#070)
- 한 이벤트를 줄이면 다른 이벤트도 함께 줄어들거나(득) 새 이벤트가 나타나거나(실) 할 수 있다.  
- 최적 조회 크기 튜닝 시, 네트워크 I/O 이벤트가 새로 등장해 더는 빨라지지 않는 지점을 확인.

### 비선형 동작 예시 (#071)
- 호출 수 25% 감소 → 대기열 효과로 호출당 시간까지 줄어들어 예측과 달라짐.  
- M/M/2에서 트래픽 강도 p를 0.9→0.6으로 낮추면 대기 지연 Q가 선형이 아닌 더 크게 개선(4.26S→0.56S).

---

[← 이전: 8장](08-problem-solving.md) | [다음: 10장 →](10-latency-hiding.md)
